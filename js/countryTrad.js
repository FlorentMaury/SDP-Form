const translationsData = {
    "fr": {
        "civility": "Civilité",
        "mr": "Monsieur",
        "mrs": "Madame",
        "child": "Enfant",
        "lastName": "Nom de famille",
        "firstName": "Prénom",
        "email": "Email",
        "country": "Pays",
        "address": "Adresse",
        "city": "Ville",
        "phoneNumber": "Numéro de téléphone",
        "host": "Hôte",
        "workshop": "Atelier",
        "discovery": "Comment nous avez-vous découverts ?",
        "allergiesQuestion": "Avez-vous des allergies empêchant de porter du parfum ?",
        "responsibilityQuestion": "Si oui, souhaitez-vous poursuivre en déclinant notre responsabilité ?",
        "rgpdQuestion": "Acceptez-vous les réglementations RGPD** ?",
        "newsQuestion": "Acceptez-vous de recevoir la newsletter* ?",
        "submit": "Soumettre",
        "yes": "Oui",
        "no": "Non",
        "Karim": "Karim",
        "Jean-Baptiste": "Jean-Baptiste",
        "Thomas": "Thomas",
        "Patrice": "Patrice",
        "Selma": "Selma",
        "Ayoush": "Ayoush",
        "Escapade olfactive": "Escapade olfactive",
        "Découverte parfumée": "Découverte parfumée",
        "Création passion": "Création passion",
        "Duo passion": "Duo passion",
        "Escapade en famille": "Escapade en famille",
        "Nez à nez": "Nez à nez",
        "Masterclass": "Masterclass",
        "Bon cadeau": "Bon cadeau",
        "Wecandoo": "Wecandoo",
        "Google": "Google",
        "TripAdvisor": "TripAdvisor",
        "Autre": "Autre",
        "Coupe de champagne": "Coupe de champagne",
        "Vaporisateur de voyage": "Vaporisateur de voyage",
        "Flacon de Murano": "Flacon de Murano",
        "Ruban personnalisé": "Ruban personnalisé",
        "Diplôme d'apprenti parfumeur": "Diplôme d'apprenti parfumeur",
        "Impression d'un bon cadeau": "Impression d'un bon cadeau",
        "rgpdMessage": "**Depuis juin 2018, conformément à la nouvelle réglementation RGPD, vos données sont collectées pour la gestion interne de votre fichier, pour d'éventuelles recommandations et pour notre gestion dynamique des stocks. Elles ne sont pas transmises à des tiers.",
        "newsletterMessage": "*Le Studio des Parfums enrichit régulièrement son orgue et également les informations du monde de la parfumerie, ainsi que des offres avantageuses, acceptez-vous de recevoir cette newsletter ?"
    },
    "pt": {
        "civility": "Civilidade",
        "mr": "Sr.",
        "mrs": "Sra.",
        "child": "Criança",
        "lastName": "Sobrenome",
        "firstName": "Nome",
        "email": "Email",
        "country": "País",
        "address": "Endereço",
        "city": "Cidade",
        "phoneNumber": "Número de telefone",
        "host": "Anfitrião",
        "workshop": "Oficina",
        "discovery": "Como nos descobriu?",
        "allergiesQuestion": "Você tem alguma alergia que impeça o uso de perfume?",
        "responsibilityQuestion": "Se sim, deseja prosseguir declinando nossa responsabilidade?",
        "rgpdQuestion": "Você aceita as normas RGPD**?",
        "newsQuestion": "Você aceita receber a newsletter*?",
        "submit": "Enviar",
        "yes": "Sim",
        "no": "Não",
        "Karim": "Karim",
        "Jean-Baptiste": "Jean-Baptiste",
        "Thomas": "Thomas",
        "Patrice": "Patrice",
        "Selma": "Selma",
        "Ayoush": "Ayoush",
        "Escapade olfactive": "Escapada olfativa",
        "Découverte parfumée": "Descoberta perfumada",
        "Création passion": "Criação de paixão",
        "Duo passion": "Duo de paixão",
        "Escapade en famille": "Escapada em família",
        "Nez à nez": "Nariz a nariz",
        "Masterclass": "Masterclass",
        "Bon cadeau": "Cartão de presente",
        "Wecandoo": "Wecandoo",
        "Google": "Google",
        "TripAdvisor": "TripAdvisor",
        "Autre": "Outro",
        "Coupe de champagne": "Taça de champanhe",
        "Vaporisateur de voyage": "Spray de viagem",
        "Flacon de Murano": "Frasco de Murano",
        "Ruban personnalisé": "Fita personalizada",
        "Diplôme d'apprenti parfumeur": "Diploma de aprendiz de perfumista",
        "Impression d'un bon cadeau": "Impressão de cartão de presente",
        "rgpdMessage": "**Desde junho de 2018, de acordo com os novos regulamentos do GDPR, seus dados são coletados para gerenciamento interno de arquivos, para possíveis recomendações e para nosso gerenciamento dinâmico de inventário. Eles não são transmitidos a terceiros.",
        "newsletterMessage": "*Le Studio des Parfums enriquece regularmente seu órgão e também as informações do mundo da perfumaria, bem como ofertas vantajosas, você aceita receber este boletim informativo?"
    },
    "es": {
        "civility": "Civilidad",
        "mr": "Sr.",
        "mrs": "Sra.",
        "child": "Niño",
        "lastName": "Apellido",
        "firstName": "Nombre",
        "email": "Correo electrónico",
        "country": "País",
        "address": "Dirección",
        "city": "Ciudad",
        "phoneNumber": "Número de teléfono",
        "host": "Anfitrión",
        "workshop": "Taller",
        "discovery": "¿Cómo nos descubrió?",
        "allergiesQuestion": "¿Tiene alguna alergia que le impida usar perfume?",
        "responsibilityQuestion": "Si es así, ¿desea continuar declinando nuestra responsabilidad?",
        "rgpdQuestion": "¿Acepta las normas RGPD**?",
        "newsQuestion": "¿Acepta recibir el boletín informativo*?",
        "submit": "Enviar",
        "yes": "Sí",
        "no": "No",
        "Karim": "Karim",
        "Jean-Baptiste": "Jean-Baptiste",
        "Thomas": "Thomas",
        "Patrice": "Patrice",
        "Selma": "Selma",
        "Ayoush": "Ayoush",
        "Escapade olfactive": "Escapada olfativa",
        "Découverte parfumée": "Descubrimiento perfumado",
        "Création passion": "Creación apasionada",
        "Duo passion": "Dúo de pasión",
        "Escapade en famille": "Escapada en familia",
        "Nez à nez": "Nariz a nariz",
        "Masterclass": "Masterclass",
        "Bon cadeau": "Tarjeta de regalo",
        "Wecandoo": "Wecandoo",
        "Google": "Google",
        "TripAdvisor": "TripAdvisor",
        "Autre": "Otro",
        "Coupe de champagne": "Copa de champán",
        "Vaporisateur de voyage": "Atomizador de viaje",
        "Flacon de Murano": "Frasco de Murano",
        "Ruban personnalisé": "Cinta personalizada",
        "Diplôme d'apprenti parfumeur": "Diploma de aprendiz de perfumista",
        "Impression d'un bon cadeau": "Impresión de tarjeta de regalo",
        "rgpdMessage": "**Desde junio de 2018, de acuerdo con la nueva normativa RGPD, sus datos se recopilan para la gestión interna de su expediente, para posibles recomendaciones y para nuestra gestión dinámica de inventario. No se transmiten a terceros.",
        "newsletterMessage": "*Le Studio des Parfums regularmente enriquece su órgano y también la información del mundo de la perfumería, así como ofertas ventajosas, ¿acepta recibir este boletín?"
    },
    "en": {
        "civility": "Civility",
        "mr": "Mr",
        "mrs": "Mrs",
        "child": "Child",
        "lastName": "Last Name",
        "firstName": "First Name",
        "email": "Email",
        "country": "Country",
        "address": "Address",
        "city": "City",
        "phoneNumber": "Phone Number",
        "host": "Host",
        "workshop": "Workshop",
        "discovery": "How did you discover us?",
        "allergiesQuestion": "Do you have any allergies that prevent you from wearing perfume?",
        "responsibilityQuestion": "If yes, do you want to proceed by declining our responsibility?",
        "rgpdQuestion": "Do you accept the GDPR regulations**?",
        "newsQuestion": "Do you accept to receive the newsletter*?",
        "submit": "Submit",
        "yes": "Yes",
        "no": "No",
        "Karim": "Karim",
        "Jean-Baptiste": "Jean-Baptiste",
        "Thomas": "Thomas",
        "Patrice": "Patrice",
        "Selma": "Selma",
        "Ayoush": "Ayoush",
        "Escapade olfactive": "Olfactory Escapade",
        "Découverte parfumée": "Scent Discovery",
        "Création passion": "Passion Creation",
        "Duo passion": "Passion Duo",
        "Escapade en famille": "Family Escapade",
        "Nez à nez": "Nose to Nose",
        "Masterclass": "Masterclass",
        "Bon cadeau": "Gift Card",
        "Wecandoo": "Wecandoo",
        "Google": "Google",
        "TripAdvisor": "TripAdvisor",
        "Autre": "Other",
        "Coupe de champagne": "Champagne Glass",
        "Vaporisateur de voyage": "Travel Spray",
        "Flacon de Murano": "Murano Bottle",
        "Ruban personnalisé": "Personalized Ribbon",
        "Diplôme d'apprenti parfumeur": "Apprentice Perfumer Diploma",
        "Impression d'un bon cadeau": "Gift Card Printing",
        "rgpdMessage": "**Since June 2018, in accordance with the new GDPR regulations, your data is collected for internal management of your file, for any recommendations, and for our dynamic stock management. They are not transmitted to third parties.",
        "newsletterMessage": "*Le Studio des Parfums regularly enriches its organ and also the information from the world of perfumery, as well as advantageous offers, do you accept to receive this newsletter?"
    }
};

document.addEventListener('DOMContentLoaded', function() {
    const flags = document.querySelectorAll('.main__flagsList img');
    const elementsToTranslate = document.querySelectorAll('.translate');
    const countrySelect = document.getElementById('country');
    const phoneNumberInput = document.getElementById('phoneNumber');

    // Charge la langue par défaut au chargement de la page
    const defaultLang = 'fr';
    loadTranslations(defaultLang);
    loadCountries(defaultLang);
    updatePhoneNumber();

    // Définit le drapeau français comme actif au chargement de la page
    document.querySelector('.flagList__fr').classList.add('flagList__active');

    flags.forEach(flag => {
        flag.addEventListener('click', function() {
            const lang = this.classList[0].split('__')[1]; // ex: "flagList__fr" => "fr"
            loadTranslations(lang);
            loadCountries(lang);
            document.getElementById('lang').value = lang; 

            // Réinitialise tous les drapeaux
            resetFlags();

            // Masque le drapeau cliqué
            this.classList.add('flagList__active');

            // Met à jour le numéro de téléphone et le code postal lors du changement de pays
            updatePhoneNumber();
        });
    });

    countrySelect.addEventListener('change', function() {
        updatePhoneNumber();
    });

    function resetFlags() {
        flags.forEach(flag => {
            flag.classList.remove('flagList__active');
        });
    }

    function loadTranslations(lang) {
        const translations = translationsData[lang];

        elementsToTranslate.forEach(element => {
            const key = element.getAttribute('data-translate-key');
            const translation = translations[key];
            if (translation) {
                if (element.tagName === 'INPUT' || element.tagName === 'SELECT') {
                    element.placeholder = translation;
                } else {
                    element.textContent = translation;
                }
            }
        });
    }

    function loadCountries(lang) {
        countrySelect.innerHTML = ''; 
    
        countries.forEach(country => {
            const option = document.createElement('option');
            option.value = country.name['fr']; // Utiliser le nom français pour la valeur
            option.textContent = country.name[lang] || country.name['en']; // Utiliser la langue de l'utilisateur
            option.setAttribute('data-dial-code', country.dial_code); // Ajouter le code de composition comme attribut
            countrySelect.appendChild(option);
        });
    }

    function updatePhoneNumber() {
        var selectedCountryIndex = countrySelect.selectedIndex;
        
        if (selectedCountryIndex >= 0) {
            var selectedCountry = countries[selectedCountryIndex];
            if (selectedCountry) {
                phoneNumberInput.value = selectedCountry.dial_code;
            }
        } else {
            phoneNumberInput.value = ''; // Efface le numéro de téléphone si aucun pays n'est sélectionné
        }
    }
});